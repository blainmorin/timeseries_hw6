---
title: "STAT 6550 HW6"
author: "Blain Morin"
date: "4/20/2021"
output: pdf_document
---

## 1. In Homework 2, we studied a time series of wind speeds (minus the gusts) recorded every twenty minutes at an airport in Fort Lauderdale, observed during the progression of Hurricane Wilma in October 2005. The data, on the square root scale, was provided in the R file for Homework 2. Start by removing the last 5 hours (15 time points) of data from the end of the time series. We will use these 15 values to assess forecasting performance in part (g). For parts (a) – (f) only use the remaining 123 values.


```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(stargazer)

## Here is the dataset of wind speeds after a square root transformation.
winds <- c(2.90, 3.06, 3.62, 3.38, 3.43, 3.07, 3.13, 3.27, 3.35, 3.21, 3.26,
           3.51, 3.21, 2.83, 2.59, 2.62, 2.88, 2.75, 2.52, 2.68, 3.13, 3.22,
           3.60, 3.47, 3.30, 3.33, 3.38, 3.27, 3.32, 3.37, 4.04, 3.94, 3.74,
           3.77, 3.79, 3.80, 3.96, 3.87, 3.68, 4.01, 4.26, 4.16, 4.32, 3.93,
           3.86, 3.79, 3.89, 4.04, 3.46, 3.26, 3.17, 3.41, 3.67, 3.68, 3.88,
           3.84, 4.05, 4.10, 3.59, 3.75, 4.00, 3.67, 4.02, 4.35, 4.09, 4.03,
           3.99, 4.13, 4.15, 4.28, 4.51, 4.54, 4.44, 4.51, 4.50, 4.47, 4.52,
           4.43, 4.93, 5.15, 4.90, 5.09, 4.95, 5.24, 5.67, 5.69, 6.12, 6.30,
           6.25, 6.47, 6.63, 6.48, 6.41, 6.58, 6.97, 7.62, 8.03, 7.98, 7.67,
           7.26, 7.51, 7.65, 7.57, 7.50, 7.86, 7.85, 7.27, 6.77, 6.81, 6.83,
           6.64, 6.49, 6.27, 6.07, 5.96, 5.64, 5.52, 5.45, 5.37, 5.18, 4.89,
           4.53, 4.31, 4.37, 4.41, 4.54, 4.68, 4.80, 4.59, 4.42, 4.14, 4.00,
           4.17, 3.95, 3.97, 3.95, 3.89, 3.97)

## Create the 'hours' variable.
hours <- seq(from=0, by=1/3, length=length(winds))

```

## (a) Produce a properly labeled time series plot of the remaining 123 values.

```{r}

df = data.frame(winds = winds, hours = hours)

train = df[1:123,]
test = df[124:138, ]


```

```{r, fig.height=4}

train %>%
  ggplot(aes(x = hours, y = winds)) +
  geom_line(size = 1.5) +
  ylab("Wind Speed (sqrt scale)") +
  xlab("Hour") +
  ggtitle("Time Series Plot for First 123 Values") +
  theme_bw()

```

\newpage

## (b) Follow the steps to carry out the Dickey-Fuller test on the square root wind speeds, as outlined in the “Modeling ARIMA and SARIMA processes” class notes. Show all your work and write down your conclusion in words.

```{r, results='asis', echo = TRUE}

### Create data frame
### y is the first difference
### x is the wind speed at the previous timepoint
df.test = data.frame(y = diff(train$winds),
                     x = df$winds[1:122],
                     hours = hours[1:122])


### Linear Model
model = lm(y ~ x, data = df.test)
sum.model = summary(model)

### Make a table with results
stargazer(model, header = FALSE, title = "Dickey-Fuller Regression Results")

```

The Dickey-Fuller statistic is $-.019/.015 = -1.277$. Using the Dickey-Fuller distribution critical value, $C_{\alpha = .05} = -2.86$, we fail to reject $H_0$. Thus, there is not enough evidence to suggest that the process is stationary.

\newpage

## (c) Based on a time series plot of the differenced square root wind series discuss whether or not stationarity is a reasonable assumption for the differenced series.

```{r, fig.height=4}

df.test %>%
  ggplot(aes(x = hours, y = y)) +
  geom_line(size = 1.5) +
  ylab("Differenced sqrt Wind Speed") +
  xlab("Hour") +
  ggtitle("Differenced Series Plot") +
  theme_bw()

```


Visually, the differenced series looks mostly stationary. We see it is mean 0 and has relatively constant variance. There is a bit of a dip after the 35 hour mark, which is maybe a bit concerning.

## (d) Examining the first fifty lags of the sample ACF and sample PACF of the differenced series, explain why an ARIMA(1,1,0) model may be reasonable for the undifferenced square root wind series.

